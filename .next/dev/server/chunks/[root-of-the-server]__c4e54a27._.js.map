{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/kleuvyn/Documentos/MeusRepositorios/Calendario_Literario/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL || process.env.POSTGRES_URL,\n  ssl: {\n    rejectUnauthorized: false \n  }\n});\n\nexport async function executeQuery(query: string, params: any[] = []) {\n  try {\n\n    await pool.query('ALTER TABLE users ADD COLUMN IF NOT EXISTS password TEXT;');\n    await pool.query('ALTER TABLE users ADD COLUMN IF NOT EXISTS image TEXT;');\n    await pool.query('ALTER TABLE reading_data ADD COLUMN IF NOT EXISTS author TEXT;');\n    await pool.query('ALTER TABLE reading_data ADD COLUMN IF NOT EXISTS rating INTEGER;');\n    await pool.query('ALTER TABLE reading_data ADD COLUMN IF NOT EXISTS cover_url TEXT;');\n    await pool.query('ALTER TABLE reading_data ADD COLUMN IF NOT EXISTS email TEXT;');\n\n    const result = await pool.query(query, params);\n    return result.rows; \n  } catch (error) {\n    console.error('Erro detalhado no Banco de Dados:', error);\n    throw error;\n  }\n}"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY,IAAI,QAAQ,GAAG,CAAC,YAAY;IACtE,KAAK;QACH,oBAAoB;IACtB;AACF;AAEO,eAAe,aAAa,KAAa,EAAE,SAAgB,EAAE;IAClE,IAAI;QAEF,MAAM,KAAK,KAAK,CAAC;QACjB,MAAM,KAAK,KAAK,CAAC;QACjB,MAAM,KAAK,KAAK,CAAC;QACjB,MAAM,KAAK,KAAK,CAAC;QACjB,MAAM,KAAK,KAAK,CAAC;QACjB,MAAM,KAAK,KAAK,CAAC;QAEjB,MAAM,SAAS,MAAM,KAAK,KAAK,CAAC,OAAO;QACvC,OAAO,OAAO,IAAI;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qCAAqC;QACnD,MAAM;IACR;AACF"}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///home/kleuvyn/Documentos/MeusRepositorios/Calendario_Literario/app/api/books/%5Bid%5D/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { executeQuery } from \"@/lib/db\";\n\nexport async function PATCH(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> } \n) {\n  try {\n    const { id } = await params; \n    const { title } = await request.json();\n    const currentData = await executeQuery(\n      \"SELECT book_name, email FROM reading_data WHERE id = $1\",\n      [id]\n    ) as any[];\n\n    if (!currentData || currentData.length === 0) {\n      return NextResponse.json({ error: \"Livro não encontrado\" }, { status: 404 });\n    }\n\n    const oldName = currentData[0].book_name;\n    const userEmail = currentData[0].email;\n    await executeQuery(\n      `UPDATE reading_data SET book_name = $1 WHERE book_name = $2 AND email = $3`,\n      [title, oldName, userEmail]\n    );\n    try {\n      await executeQuery(\n        `UPDATE book_reviews SET book_name = $1 WHERE book_name = $2 AND user_email = $3`,\n        [title, oldName, userEmail]\n      );\n    } catch (e) { \n      console.log(\"Tabela book_reviews não encontrada ou coluna diferente, pulando...\"); \n    }\n\n    return NextResponse.json({ message: \"Atualizado com sucesso!\" });\n  } catch (error: any) {\n    console.error(\"Erro Crítico na API:\", error);\n    return NextResponse.json({ error: error.message }, { status: 500 });\n  }\n}\n\nexport async function DELETE(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params;\n  \n    const data = await executeQuery(\"SELECT book_name, email FROM reading_data WHERE id = $1\", [id]) as any[];\n    \n    if (data.length > 0) {\n      const { book_name, email } = data[0];\n      await executeQuery(\"DELETE FROM reading_data WHERE book_name = $1 AND email = $2\", [book_name, email]);\n      await executeQuery(\"DELETE FROM book_reviews WHERE book_name = $1 AND user_email = $2\", [book_name, email]);\n    }\n\n    return NextResponse.json({ message: \"Excluído de todo o sistema\" });\n  } catch (error) {\n    return NextResponse.json({ error: \"Erro ao deletar\" }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;;;AAEO,eAAe,MACpB,OAAgB,EAChB,EAAE,MAAM,EAAuC;IAE/C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QACrB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,QAAQ,IAAI;QACpC,MAAM,cAAc,MAAM,IAAA,2HAAY,EACpC,2DACA;YAAC;SAAG;QAGN,IAAI,CAAC,eAAe,YAAY,MAAM,KAAK,GAAG;YAC5C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAuB,GAAG;gBAAE,QAAQ;YAAI;QAC5E;QAEA,MAAM,UAAU,WAAW,CAAC,EAAE,CAAC,SAAS;QACxC,MAAM,YAAY,WAAW,CAAC,EAAE,CAAC,KAAK;QACtC,MAAM,IAAA,2HAAY,EAChB,CAAC,0EAA0E,CAAC,EAC5E;YAAC;YAAO;YAAS;SAAU;QAE7B,IAAI;YACF,MAAM,IAAA,2HAAY,EAChB,CAAC,+EAA+E,CAAC,EACjF;gBAAC;gBAAO;gBAAS;aAAU;QAE/B,EAAE,OAAO,GAAG;YACV,QAAQ,GAAG,CAAC;QACd;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAA0B;IAChE,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF;AAEO,eAAe,OACpB,OAAgB,EAChB,EAAE,MAAM,EAAuC;IAE/C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QAErB,MAAM,OAAO,MAAM,IAAA,2HAAY,EAAC,2DAA2D;YAAC;SAAG;QAE/F,IAAI,KAAK,MAAM,GAAG,GAAG;YACnB,MAAM,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,EAAE;YACpC,MAAM,IAAA,2HAAY,EAAC,gEAAgE;gBAAC;gBAAW;aAAM;YACrG,MAAM,IAAA,2HAAY,EAAC,qEAAqE;gBAAC;gBAAW;aAAM;QAC5G;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAA6B;IACnE,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkB,GAAG;YAAE,QAAQ;QAAI;IACvE;AACF"}}]
}