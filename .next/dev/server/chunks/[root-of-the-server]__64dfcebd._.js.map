{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///home/kleuvyn/Documentos/MeusRepositorios/Calendario_Literario/app/api/reading-data/route.ts"],"sourcesContent":["// Dentro do seu arquivo route.ts, na parte do POST:\n\nif (action === \"START_READING\") {\n  let autoCover = \"\";\n  let autoPages = 0;\n\n  try {\n    // Busca os dados no Google Books\n    const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(bookName)}`);\n    const bookData = await response.json();\n    \n    if (bookData.items && bookData.items.length > 0) {\n      const info = bookData.items[0].volumeInfo;\n      autoCover = info.imageLinks?.thumbnail?.replace(\"http:\", \"https:\") || \"\";\n      autoPages = info.pageCount || 0;\n    }\n  } catch (e) {\n    console.error(\"Erro ao buscar dados do livro automaticamente\");\n  }\n\n  await executeQuery(`\n    INSERT INTO public.reading_data (email, user_id, book_name, start_date, year, month, status, total_pages)\n    VALUES ($1, $2, $3, $4, $5, $6, 'lendo', $7)\n  `, [email, userId, bookName, startDate, year, month, autoPages]);\n\n  // Se achou uma capa, já cria o review para a capa aparecer no calendário\n  if (autoCover) {\n    await executeQuery(`\n      INSERT INTO public.book_reviews (user_id, title, cover_url, total_pages, year, month)\n      VALUES ($1, $2, $3, $4, $5, $6)\n      ON CONFLICT (user_id, title) DO NOTHING\n    `, [userId, bookName, autoCover, autoPages, year, month]);\n  }\n}"],"names":[],"mappings":"AAAA,oDAAoD;AAEpD,IAAI,WAAW,iBAAiB;IAC9B,IAAI,YAAY;IAChB,IAAI,YAAY;IAEhB,IAAI;QACF,iCAAiC;QACjC,MAAM,WAAW,MAAM,MAAM,CAAC,8CAA8C,EAAE,mBAAmB,WAAW;QAC5G,MAAM,WAAW,MAAM,SAAS,IAAI;QAEpC,IAAI,SAAS,KAAK,IAAI,SAAS,KAAK,CAAC,MAAM,GAAG,GAAG;YAC/C,MAAM,OAAO,SAAS,KAAK,CAAC,EAAE,CAAC,UAAU;YACzC,YAAY,KAAK,UAAU,EAAE,WAAW,QAAQ,SAAS,aAAa;YACtE,YAAY,KAAK,SAAS,IAAI;QAChC;IACF,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC;IAChB;IAEA,MAAM,aAAa,CAAC;;;EAGpB,CAAC,EAAE;QAAC;QAAO;QAAQ;QAAU;QAAW;QAAM;QAAO;KAAU;IAE/D,yEAAyE;IACzE,IAAI,WAAW;QACb,MAAM,aAAa,CAAC;;;;IAIpB,CAAC,EAAE;YAAC;YAAQ;YAAU;YAAW;YAAW;YAAM;SAAM;IAC1D;AACF"}}]
}